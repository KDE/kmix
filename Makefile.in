# This is a sample Makefile.in 

# @CXXFLAGS@     : is set to -g -Wall (when debuging) or -O2 -Wall (when not)
# @all_includes@ : is set to all needed include paths for QT, KDE and X11
# -I.. 	         : needed for config.h
CXXFLAGS= @CXXFLAGS@ @all_includes@ -DHAVE_CONFIG_H -I..

# @LDFLAGS@    : is set to -s (when not debuging) for stripping
# @all_libra.@ : is set to all needed libraries paths for QT, KDE and X11
# you need also @LIBSOCKET@, if you link with -lkfm
LDFLAGS	= @LDFLAGS@ @all_libraries@ -lkdecore -lkdeui -lqt -lXext -lX11

top_builddir = ..
kde_libraries = @kde_libraries@
qt_libraries = @qt_libraries@
LIBTOOL = @LIBTOOL@
KDE_RPATH = @KDE_RPATH@

# both are clear, I think
CXX     = @CXX@
MOC   	= @MOC@

############# INSTALL #################

install = @INSTALL@
INSTALL = $(install) -m 0755
INSTALL_DATA = $(install) -m 0644
INSTALL_DIR = $(install) -d -m 0755
INSTALL_DIR_PRIVATE = $(install) -d -m 0700

prefix = @prefix@
install_root = @install_root@
BINDIR = @kde_bindir@
APPDIR = @kde_datadir@/kmix

########### File Formats ###########

.SUFFIXES: .cpp

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $<

########## Files #####################

OBJECTS =	kmix.o mixer.o prefs.o kcontextmenu.o
SRCS :=         $(OBJECTS:*.o:*.cpp)
SRCMETA =	kmix.moc prefs.moc mixer.moc
#SRCNLS  :=	$(patsubst %.po,%, $(wildcard *.po))
#OBJNLS  :=	$(patsubst %,%.mo, $(SRCNLS))
TARGET	=	kmix

######### build rules ################

all: .depend version.h $(TARGET)


version.h: VERSION
	sed "s/0/#define APP_VERSION 0/" <VERSION >version.h

$(TARGET): $(SRCMETA) $(OBJECTS)
	$(LIBTOOL) --mode=link $(CXX) $(OBJECTS) -o $(TARGET) $(LDFLAGS) $(KDE_RPATH)

clean:
	rm -f *.o *.bak .depend *~ *% core "#*"
	rm -f $(SRCMETA) $(TARGET)
	rm -f *.mo

distclean: clean
	rm -f Makefile


nls:
	xgettext --keyword=translate *.cpp
	mv messages.po kmix.po

.depend: $(SRCS) *.h
	$(MAKE) depend

depend:
# Does not work :-(
#makedepend -I$(QTDIR)/include -I$(KDEDIR)/include *.cpp
	touch .depend

install: $(TARGET) install-icons # install-nls
	$(INSTALL_DIR) $(BINDIR)
	$(INSTALL) $(TARGET) $(BINDIR)
	$(INSTALL_DIR) @kde_htmldir@/en/kmedia
	$(INSTALL_DATA) kmix.html @kde_htmldir@/en/kmedia
	$(INSTALL_DIR) @kde_appsdir@/Multimedia
	$(INSTALL_DATA) KMix.kdelnk @kde_appsdir@/Multimedia

install-icons:
	(cd pics && $(MAKE) install)

#install-nls:
#	for i in $(SRCNLS); do \
#	$(INSTALL_DIR) $(prefix)/share/locale/$$i/LC_MESSAGES; \
#	$(INSTALL_DATA) $$i.mo $(prefix)/share/locale/$$i/LC_MESSAGES/kmix.mo; \
#	done


uninstall:
	rm -f $(BINDIR)/$(TARGET)
	rm -f @kde_htmldir@/en/kmedia/kmix.html
	rm -f @kde_appsdir@/Multimedia/KMix.kdelnk
	rm -rf $(APPDIR)
	(cd pics && $(MAKE) uninstall)

kmix.moc: kmix.h
	$(MOC) kmix.h -o kmix.moc

prefs.moc: prefs.h
	$(MOC) prefs.h -o prefs.moc

mixer.moc: mixer.h
	$(MOC) mixer.h -o mixer.moc



# DO NOT DELETE THIS LINE -- make depend depends on it.
